/*
* This configuration is applied to the openapi REST client subproject automatically
* generated by openapi-generator. It applies the libraries-publish plugin from the libraries-publish.gradle configuration
*/

subprojects { project ->
	if (project.name.contains("client-rest")) {

		apply plugin: 'java-library'
		apply plugin: "org.springframework.boot"
		apply plugin: "io.spring.dependency-management"

		// Check if the java source files are present, otherwise does not apply the publish configuration
		def srcDir = project.sourceSets.main.java.srcDirs.first()
		if (srcDir.exists()) {
			// Apply the publish configuration to the subproject auto-generated by OpenAPI generator
			apply from: 'https://raw.githubusercontent.com/TreC-MM/TreC-MM-Config/main/libraries-publish.gradle'
		}


		// OpenAPI client common files
		// dependencies {
		//     api "eu.fbk.trec:openapi-client-common:+"
		// }

		ext {
			lombok_version = "1.18.+"
			swagger_annotations_v2_version = "1.6.2"
			jackson_databind_nullable_version = "0.2.1"
			trec_server_starter_version = "+"
		}

		// Apply minimum dependencies required by OpenAPI
		dependencies {

			// Spring configuration
			compileOnly "org.springframework.boot:spring-boot-autoconfigure"
			compileOnly "org.springframework.boot:spring-boot-starter-webflux"

			// Lombok
			compileOnly "org.projectlombok:lombok:$lombok_version"
			annotationProcessor "org.projectlombok:lombok:$lombok_version"

			// Data Validation
			compileOnly "javax.annotation:javax.annotation-api"
			compileOnly "com.google.code.findbugs:jsr305:3.0.2"
			compileOnly "javax.validation:validation-api"
			compileOnly "org.hibernate.validator:hibernate-validator"

			// TreC
			compileOnly "eu.fbk.trec:lib-server-starter:$trec_server_starter_version"

			// Others
			implementation "io.swagger:swagger-annotations:$swagger_annotations_v2_version"
			implementation "org.openapitools:jackson-databind-nullable:$jackson_databind_nullable_version"

		}
	}
}
